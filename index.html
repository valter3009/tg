<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alias</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            background-color: #fff;
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .logo {
            font-size: 2rem;
            color: #ff4757;
            text-align: center;
            margin-bottom: 30px;
        }

        .button {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .button-primary {
            background-color: #2196F3;
            color: white;
        }

        .button-orange {
            background-color: #ff9f43;
            color: white;
        }

        .screen {
            display: none;
        }

        .screen.active {
            display: block;
        }

        .player-count {
            text-align: center;
            font-size: 2rem;
            color: #ff4757;
            margin: 20px 0;
        }

        .player-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .player-controls button {
            width: 50px;
            height: 50px;
            border-radius: 25px;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .team-list {
            margin: 20px 0;
        }

        .team-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            padding: 10px;
            background-color: #f1f2f6;
            border-radius: 10px;
        }

        .team-icon {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .word-sets {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 20px 0;
        }

        .word-set {
            position: relative;
            aspect-ratio: 1;
            border-radius: 10px;
            overflow: hidden;
            cursor: pointer;
        }

        .word-set img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .word-set-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 10px;
            background: rgba(0,0,0,0.5);
            color: white;
        }

        .settings-item {
            margin: 20px 0;
        }

        .settings-label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .slider {
            width: 100%;
            height: 30px;
            background: #f1f2f6;
            border-radius: 15px;
            position: relative;
            margin: 10px 0;
        }

        .slider-handle {
            width: 40px;
            height: 30px;
            background: #2196F3;
            border-radius: 15px;
            position: absolute;
            cursor: pointer;
        }

        .toggle {
            width: 60px;
            height: 30px;
            background: #f1f2f6;
            border-radius: 15px;
            position: relative;
            cursor: pointer;
        }

        .toggle-handle {
            width: 26px;
            height: 26px;
            background: white;
            border-radius: 13px;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: all 0.3s ease;
        }

        .toggle.active {
            background: #2196F3;
        }

        .toggle.active .toggle-handle {
            left: 32px;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .timer {
            font-size: 2rem;
            font-weight: bold;
            color: #2196F3;
        }

        .score {
            font-size: 1.5rem;
        }

        .word-card {
            background: white;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            font-size: 2rem;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .game-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        @media (max-width: 480px) {
            .word-sets {
                grid-template-columns: 1fr;
            }
            
            .button {
                padding: 12px;
                font-size: 0.9rem;
            }
            
            .word-card {
                font-size: 1.5rem;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Главное меню -->
        <div id="menu" class="screen active">
            <div class="logo">Alias</div>
            <button class="button button-primary" onclick="showScreen('playerSelect')">Играть</button>
            <button class="button button-orange" onclick="showScreen('rules')">Правила</button>
            <button class="button button-orange" onclick="showScreen('settings')">Настройки</button>
        </div>

        <!-- Выбор количества игроков -->
        <div id="playerSelect" class="screen">
            <div class="player-count">
                <div>Сколько будет игроков?</div>
                <div id="playerCount">2</div>
            </div>
            <div class="player-controls">
                <button onclick="adjustPlayers(-1)">-</button>
                <button onclick="adjustPlayers(1)">+</button>
            </div>
            <button class="button button-primary" onclick="showScreen('teamSelect')">Продолжить</button>
            <button class="button button-orange" onclick="showScreen('menu')">Назад</button>
        </div>

        <!-- Выбор команд -->
        <div id="teamSelect" class="screen">
            <div class="team-list" id="teamList">
                <!-- Команды добавляются динамически -->
            </div>
            <button class="button button-primary" onclick="showScreen('wordSets')">Продолжить</button>
            <button class="button button-orange" onclick="showScreen('playerSelect')">Назад</button>
        </div>

        <!-- Наборы слов -->
        <div id="wordSets" class="screen">
            <div class="word-sets">
                <div class="word-set" onclick="selectWordSet('basic')">
                    <img src="/api/placeholder/400/400" alt="Базовый набор">
                    <div class="word-set-info">
                        <div>Базовый набор</div>
                        <div>3060 слов</div>
                    </div>
                </div>
                <!-- Остальные наборы -->
            </div>
            <button class="button button-primary" onclick="startGame()">Продолжить</button>
            <button class="button button-orange" onclick="showScreen('teamSelect')">Назад</button>
        </div>

        <!-- Настройки -->
        <div id="settings" class="screen">
            <div class="settings-item">
                <label class="settings-label">Длительность раунда</label>
                <div class="slider">
                    <div class="slider-handle" id="roundTimeHandle"></div>
                </div>
                <div id="roundTimeValue">60 сек</div>
            </div>
            
            <div class="settings-item">
                <label class="settings-label">Очков для победы</label>
                <div class="slider">
                    <div class="slider-handle" id="winScoreHandle"></div>
                </div>
                <div id="winScoreValue">50 очков</div>
            </div>

            <div class="settings-item">
                <label class="settings-label">Отнимать очки за пропуск</label>
                <div class="toggle" id="penaltyToggle">
                    <div class="toggle-handle"></div>
                </div>
            </div>

            <div class="settings-item">
                <label class="settings-label">Звуки</label>
                <div class="toggle" id="soundToggle">
                    <div class="toggle-handle"></div>
                </div>
            </div>

            <button class="button button-primary" onclick="saveSettings()">Сохранить</button>
            <button class="button button-orange" onclick="showScreen('menu')">Назад</button>
        </div>

        <!-- Игра -->
        <div id="game" class="screen">
            <div class="game-header">
                <div class="timer" id="timer">60</div>
                <div class="score" id="score">0</div>
            </div>
            <div class="word-card" id="currentWord"></div>
            <div class="game-controls">
                <button class="button button-primary" onclick="wordGuessed()">Угадали</button>
                <button class="button button-orange" onclick="wordSkipped()">Пропустить</button>
            </div>
        </div>
    </div>

    <script>
        // Состояние игры
        const gameState = {
            players: 2,
            teams: [],
            currentTeam: 0,
            currentWord: '',
            timer: 60,
            settings: {
                roundTime: 60,
                winScore: 50,
                penalty: false,
                sound: true
            },
            words: {
                basic: ['слово1', 'слово2', 'слово3'], // Здесь будет полный набор слов
                science: ['наука1', 'наука2', 'наука3'],
                // Остальные наборы слов
            },
            selectedWordSet: 'basic'
        };

        // Управление экранами
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
            
            if (screenId === 'teamSelect') {
                updateTeamList();
            }
        }

        // Управление количеством игроков
        function adjustPlayers(delta) {
            gameState.players = Math.max(2, Math.min(8, gameState.players + delta));
            document.getElementById('playerCount').textContent = gameState.players;
        }

        // Обновление списка команд
        function updateTeamList() {
            const teamList = document.getElementById('teamList');
            teamList.innerHTML = '';
            
            for (let i = 0; i < gameState.players / 2; i++) {
                const teamItem = document.createElement('div');
                teamItem.className = 'team-item';
                teamItem.innerHTML = `
                    <div class="team-icon">👥</div>
                    <input type="text" placeholder="Название команды ${i + 1}" 
                           value="${gameState.teams[i]?.name || ''}"
                           onchange="updateTeamName(${i}, this.value)">
                `;
                teamList.appendChild(teamItem);
            }
        }

        // Обновление имени команды
        function updateTeamName(index, name) {
            if (!gameState.teams[index]) {
                gameState.teams[index] = { name, score: 0 };
            } else {
                gameState.teams[index].name = name;
            }
        }

        // Выбор набора слов
        function selectWordSet(setName) {
            gameState.selectedWordSet = setName;
        }

        // Сохранение настроек
        function saveSettings() {
            // Сохраняем настройки в gameState
            showScreen('menu');
        }

        // Начало игры
        function startGame() {
            gameState.currentWord = getNextWord();
            updateGameUI();
            showScreen('game');
            startTimer();
        }

        // Получение следующего слова
        function getNextWord() {
            const words = gameState.words[gameState.selectedWordSet];
            return words[Math.floor(Math.random() * words.length)];
        }

        // Обновление игрового интерфейса
        function updateGameUI() {
            document.getElementById('currentWord').textContent = gameState.currentWord;
            document.getElementById('score').textContent = 
                gameState.teams[gameState.currentTeam].score;
            document.getElementById('timer').textContent = gameState.timer;
        }

        // Запуск таймера
        function startTimer() {
            const timerInterval = setInterval(() => {
                gameState.timer--;
                document.getElementById('timer').textContent = gameState.timer;
                
                if (gameState.timer <= 0) {
                    clearInterval(timerInterval);
                    endRound();
                }
            }, 1000);
        }

        // Обработка угаданного слова
        function wordGuessed() {
            gameState.teams[gameState.currentTeam].score++;
            gameState.currentWord = getNextWord();
            updateGameUI();
        }

        // Обработка пропущенного слова
        function wordSkipped() {
            if (gameState.settings.penalty) {
                gameState.teams[gameState.currentTeam].score = 
                    Math.max(0, gameState.teams[gameState.currentTeam].score - 1);
            }
            gameState.currentWord = getNextWord();
            updateGameUI();
        }

        // Завершение раунда
        function endRound() {
            gameState.currentTeam = (gameState.currentTeam + 1) % gameState.teams.length;
            gameState.timer = gameState.settings.roundTime;
            
            if (gameState.teams.some(team => team.score >= gameState.settings.winScore)) {
                endGame();
            } else {
                startGame();
            }
        }

        // Завершение игры
        function endGame() {
            const winner = gameState.teams.reduce((prev, current) => 
                (prev.score > current.score) ? prev : current
            );
            
            alert(`Победила команда "${winner.name}" со счетом ${winner.score}!`);
            resetGame();
            showScreen('menu');
        }

        // Сброс игры
        function resetGame() {
            gameState.teams.forEach(team => team.score = 0);
            gameState.currentTeam = 0;
            gameState.timer = gameState.settings.roundTime;
        }

        // Инициализация настроек
        function initSettings() {
            const roundTimeHandle = document.getElementById('roundTimeHandle');
            const winScoreHandle = document.getElementById('winScoreHandle');
            const penaltyToggle = document.getElementById('penaltyToggle');
            const soundToggle = document.getElementById('soundToggle');

            // Инициализация слайдеров
            setupSlider(roundTimeHandle, [30, 60, 90], value => {
                gameState.settings.roundTime = value;
                document.getElementById('roundTimeValue').textContent = `${value} сек`;
            });

            setupSlider(winScoreHandle, [25, 50, 75, 100], value => {
                gameState.settings.winScore = value;
                document.getElementById('winScoreValue').textContent = `${value} очков`;
            });

            // Инициализация переключателей
            setupToggle(penaltyToggle, checked => {
                gameState.settings.penalty = checked;
            });

            setupToggle(soundToggle, checked => {
                gameState.settings.sound = checked;
            });
        }

        // Настройка слайдера
        function setupSlider(handle, values, onChange) {
            let isDragging = false;
            const slider = handle.parentElement;
            const sliderRect = slider.getBoundingClientRect();
            const stepSize = sliderRect.width / (values.length - 1);

            function updatePosition(clientX) {
                const relativeX = clientX - sliderRect.left;
                const step = Math.round(relativeX / stepSize);
                const value = values[Math.max(0, Math.min(values.length - 1, step))];
                const position = step * stepSize;
                
                handle.style.left = `${position}px`;
                onChange(value);
            }

            handle.addEventListener('mousedown', e => {
                isDragging = true;
                e.preventDefault();
            });

            document.addEventListener('mousemove', e => {
                if (isDragging) {
                    updatePosition(e.clientX);
                }
            });

            document.addEventListener('mouseup', () => {
                isDragging = false;
            });

            // Мобильная поддержка
            handle.addEventListener('touchstart', e => {
                isDragging = true;
                e.preventDefault();
            });

            document.addEventListener('touchmove', e => {
                if (isDragging) {
                    const touch = e.touches[0];
                    updatePosition(touch.clientX);
                }
            });

            document.addEventListener('touchend', () => {
                isDragging = false;
            });
        }

        // Настройка переключателя
        function setupToggle(toggle, onChange) {
            toggle.addEventListener('click', () => {
                toggle.classList.toggle('active');
                onChange(toggle.classList.contains('active'));
            });
        }

        // Наборы слов (базовые наборы, остальные можно добавить позже)
        const wordSets = {
            basic: [
                // Базовый набор слов (3060 слов)
                'дом', 'кошка', 'собака', 'дерево', 'солнце', 'луна', 'звезда',
                'вода', 'огонь', 'земля', 'воздух', 'книга', 'ручка', 'карандаш',
                // ... добавить остальные слова
            ],
            science: [
                // Научный набор (300 слов)
                'атом', 'молекула', 'энергия', 'гравитация', 'электрон', 'протон',
                'нейтрон', 'реакция', 'формула', 'теорема', 'гипотеза', 'опыт',
                // ... добавить остальные слова
            ],
            newYear: [
                // Новогодний набор (300 слов)
                'ёлка', 'подарок', 'гирлянда', 'снег', 'мороз', 'снеговик',
                'сани', 'каток', 'варежки', 'шапка', 'праздник', 'салют',
                // ... добавить остальные слова
            ],
            plants: [
                // Растения (400 слов)
                'роза', 'тюльпан', 'ромашка', 'дуб', 'берёза', 'ель', 'сосна',
                'трава', 'мох', 'гриб', 'цветок', 'лист', 'корень', 'стебель',
                // ... добавить остальные слова
            ],
            tolkien: [
                // Вселенная Толкиена (400 слов)
                'хоббит', 'кольцо', 'гэндальф', 'саурон', 'фродо', 'голлум',
                'мордор', 'шир', 'эльф', 'гном', 'орк', 'назгул', 'арагорн',
                // ... добавить остальные слова
            ],
            literature: [
                // Литературные герои (250 слов)
                'онегин', 'печорин', 'чацкий', 'базаров', 'раскольников',
                'анна_каренина', 'чичиков', 'обломов', 'донкихот', 'гамлет',
                // ... добавить остальные слова
            ],
            adult: [
                // 18+ набор (500 слов)
                // Добавить соответствующие слова
            ]
        };

        // Звуковые эффекты
        const sounds = {
            correct: new Audio('data:audio/wav;base64,UklGRn4AAABXQVZFZm10IBAAAAABAAEAxD4AAIC+AAACAAAAZGF0YVoAAAA...'), // Base64 звука
            wrong: new Audio('data:audio/wav;base64,UklGRn4AAABXQVZFZm10IBAAAAABAAEAxD4AAIC+AAACAAAAZGF0YVoAAAA...'),  // Base64 звука
            tick: new Audio('data:audio/wav;base64,UklGRn4AAABXQVZFZm10IBAAAAABAAEAxD4AAIC+AAACAAAAZGF0YVoAAAA...')   // Base64 звука
        };

        // Воспроизведение звука
        function playSound(soundName) {
            if (gameState.settings.sound) {
                sounds[soundName].currentTime = 0;
                sounds[soundName].play().catch(() => {}); // Игнорируем ошибки автовоспроизведения
            }
        }

        // Правила игры
        const rules = `
            Правила игры Alias:
            1. Игроки делятся на команды по 2 человека
            2. Задача - объяснить как можно больше слов своей команде за отведенное время
            3. Нельзя использовать однокоренные слова при объяснении
            4. За каждое угаданное слово команда получает 1 очко
            5. За пропуск слова может сниматься очко (зависит от настроек)
            6. Побеждает команда, первой набравшая нужное количество очков
        `;

        // Инициализация игры
        document.addEventListener('DOMContentLoaded', () => {
            initSettings();
            
            // Добавляем обработку клавиш
            document.addEventListener('keydown', e => {
                if (document.getElementById('game').classList.contains('active')) {
                    if (e.code === 'ArrowUp' || e.code === 'Space') {
                        e.preventDefault();
                        wordGuessed();
                    } else if (e.code === 'ArrowDown') {
                        e.preventDefault();
                        wordSkipped();
                    }
                }
            });
        });
    </script>
</body>
</html>
